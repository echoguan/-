# Java多线程

###什么是多线程？线程和进程有啥区别？
进程是受操作系统管理的基本运行单元。完全可以将运行内存中的exe文件理解成进程。当你运行了一个程序，你就启动了一个进程。显然，程序只是一组指令的有序集合，它本身没有任何运行的含义，只是一个静态实体。而进程则不同，它是程序在某个数据集上的执行，是个动态实体。它因创建而产生，因调度而运行，因等待资源或事件而处于被等待状态，因完成任务而被撤消，反应了一个程序在一定数据集上运行的全部动态过程。

线程可以理解为进程中独立运行的子任务。比如QQ.exe运行时就有很多子任务在同时运行，下载文件线程、发送信息线程等。

线程和进程的区别和联系
区别：
1.不同的操作系统资源管理方式。进程有独立的地址，一个进程崩溃后，在保护模式下不会对其他进程产生影响，而线程只是进程中的一个不同的执行路径。线程有自己的堆栈和局部变量，但线程之间没有单独的地址空间，一个线程死掉就等于整个进程死掉。所以多进程的程序比多线程的程序更加健壮。但对于一些要求同时进行并且又要共享某些变量的并发操作，只能用线程，不能用进程。
2.每一个线程有一个程序运行的入口、顺序执行序列和程序的出口。但线程不能独立执行，必须依存于进程中执行，由进程提供多个线程执行控制。
3.多线程的意义在于一个应用程序中，有多个执行部分可以同时执行。但操作系统并没有将多个线程看做多个独立的应用先，来实现进程的调度和管理以及资源分配。

联系：1.一个程序至少有一个进程，一个进程至少有一个线程。线程是属于进程的，线程运行在进程空间内，同一进程所产生的线程共享同一内存空间，当进程退出时该进程所产生的线程都会被强制退出并清除。线程可与属于同一进程的其它线程共享进程所拥有的全部资源，但是其本身基本上不拥有系统资源，只拥有一点在运行中必不可少的信息(如程序计数器、一组寄存器和栈)。



线程和进程优缺点：线程共享内存，开销小，但不利于资源的管理和保护；进程恰恰相反。线程适合于在SMP机器（多CPU）上运行，而进程则可以跨机器迁移。
	

多线程在计算机内如何实现：
在同一个时间里，同一个计算机系统中如果允许两个或两个以上的进程处于运行状态，这便是多任务。现代的操作系统几乎都是多任务操作系统，能够同时管理多个进程的运行。 多任务带来的好处是明显的，比如你可以边听mp3边上网，与此同时甚至可以将下载的文档打印出来，而这些任务之间丝毫不会相互干扰。那么这里就涉及到并行的问题，俗话说，一心不能二用，这对计算机也一样，原则上一个CPU只能分配给一个进程，以便运行这个进程。我们通常使用的计算机中只有一个CPU，也就是说只有一颗心，要让它一心多用，同时运行多个进程，就必须使用并发技术。实现并发技术相当复杂，最容易理解的是“时间片轮转进程调度算法”，它的思想简单介绍如下：在操作系统的管理下，所有正在运行的进程轮流使用CPU，每个进程允许占用CPU的时间非常短(比如10毫秒)，这样用户根本感觉不出来CPU是在轮流为多个进程服务，就好象所有的进程都在不间断地运行一样。但实际上在任何一个时间内有且仅有一个进程占有CPU。
如果一台计算机有多个CPU，情况就不同了，如果进程数小于CPU数，则不同的进程可以分配给不同的CPU来运行，这样，多个进程就是真正同时运行的，这便是并行。但如果进程数大于CPU数，则仍然需要使用并发技术。
在Windows中，进行CPU分配是以线程为单位的，一个进程可能由多个线程组成，这时情况更加复杂，但简单地说，有如下关系：
总线程数<= CPU数量：并行运行
总线程数> CPU数量：并发运行
并行运行的效率显然高于并发运行，所以在多CPU的计算机中，多任务的效率比较高。但是，如果在多CPU计算机中只运行一个进程(线程)，就不能发挥多CPU的优势。
 多任务操作系统(如Windows)的基本原理是:操作系统将CPU的时间片分配给多个线程,每个线程在操作系统指定的时间片内完成(注意,这里的多个线程是分属于不同进程的).操作系统不断的从一个线程的执行切换到另一个线程的执行,如此往复,宏观上看来,就好像是多个线程在一起执行.由于这多个线程分属于不同的进程,因此在我们看来,就好像是多个进程在同时执行,这样就实现了多任务。

引入多线程的好处：
1.在进程内创建、终止线程比创建、终止进程要快	；
2.在同一进程内线程之间的切换比进程间的切换要快，尤其是用户级线程间的切换。



